<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>4 User Guide 0.4.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/get-started.html"><strong>2</strong><span>Get Started</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/conventions.html"><strong>3</strong><span>A Word about Conventions</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/usage.html"><strong>4</strong><span>User Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/configuration.html"><strong>5</strong><span>Configuration Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/deployment.html"><strong>6</strong><span>Deployment Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/testing.html"><strong>7</strong><span>Testing Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/resources.html"><strong>8</strong><span>Further Resources</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><span style="white-space: nowrap"><img alt="camunda Logo" title="camunda Grails plugin" src="http://plexiti.github.io/camunda-grails-plugin/img/camunda.png" style="margin-right: 10px"/><span style="vertical-align: middle; font-size: 2.5em">camunda Grails plugin</span><br/><br/></span></span>
        
        
        <span id="sponsor"><span style="vertical-align: middle"><a href="http://plexiti.com" target="_blank"><img alt="plexiti Logo" title="plexiti GmbH" src="http://plexiti.github.io/camunda-grails-plugin/img/plexiti.png"/></a></span></span>
        
    </div>
    <p>The camunda Grails plugin integrates the camunda BPM platform with the Grails web application framework.</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/conventions.html">&lt;&lt; <strong>3</strong><span>A Word about Conventions</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/configuration.html"><strong>5</strong><span>Configuration Guide</span> >></a></div>
                


                <div class="project">
                    <h1>4 User Guide - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Martin Schimak</p>

                    <p><strong>Version:</strong> 0.4.0</p>

                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#script-create-process"><strong>4.1</strong><span>Create a process definition</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#services"><strong>4.2</strong><span>Inject camunda API Services</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#embedded-forms"><strong>4.3</strong><span>Develop a camunda BPM tasklist application</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#custom-form-controllers"><strong>4.4</strong><span>Redirect camunda BPM tasklist to your own grails application</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="usage">4 User Guide</h1>
After having <a href="../guide/single.html#install" class="guide">installed</a> the plugin you can immediately start to use the camunda
process engine.


<h2 id="script-create-process">4.1 Create a process definition</h2>
You can create a <strong class="bold">BPMN 2.0</strong> process definition by issueing the following command:<p class="paragraph"/><div class="code"><pre>grails create&#45;process &#91;name&#93;</pre></div><p class="paragraph"/>As name choose a 'package and class' like name of your choice, e.g. "<strong class="bold">org.camunda.my.TestProcess</strong>".
You should see the following two files generated by Grails:<p class="paragraph"/><div class="code"><pre>| Created file grails&#45;app/processes/org/camunda/my/TestProcess.bpmn
| Created file test/integration/org/camunda/my/TestProcessSpec.groovy</pre></div><p class="paragraph"/>You may now want to look at the generated BPMN process definition by making use of <a href="http://camunda.org/bpmn/tool/" target="blank">camunda
modeler</a>. It's a minimal process, but enough to get you started with user tasks and
services and to build upon:<p class="paragraph"/><img border="0" class="center" src="../img/TestProcessModeler.png"></img><p class="paragraph"/>Furthermore you will find a 'spock' based integration spec executing and checking that process. It
does have a bit more content than your typical almost empty Grails spec template...<p class="paragraph"/><div class="code"><pre>&#91;...&#93;
given: <span class="java&#45;quote">"a <span class="java&#45;keyword">new</span> instance of TestProcess"</span>
runtimeService.startProcessInstanceByKey(<span class="java&#45;quote">"TestProcess"</span>)<p class="paragraph"/>when: <span class="java&#45;quote">"completing the user task"</span>
def task = taskService.createTaskQuery().singleResult()
taskService.complete(task.id)<p class="paragraph"/>then: <span class="java&#45;quote">"the service method defined <span class="java&#45;keyword">for</span> the subsequent service task was called exactly once"</span>
1 &#42; sampleTestProcessService.serviceMethod(_ as Execution)
&#91;...&#93;</pre></div><p class="paragraph"/>&#8230; again to get you started with typical process testing boilerplate readily adapted to your freshly created
process definition and to build upon. Please check out the chapter about <a href="../guide/single.html#conventions" class="guide">conventions</a> in order
to fully appreciate the consequences of the process template being generated for you.



<h2 id="services">4.2 Inject camunda API Services</h2>
You can easily use the process engine internally in your application. Just inject 
the camunda process engine API services into your grails artifacts (like
controllers, services, etc). The following services can be found in the package
<a href="http://docs.camunda.org/latest/api-references/javadoc/org/camunda/bpm/engine/package-summary.html" target="blank">org.camunda.bpm.engine</a>
and are made available under their 'bean style' class names, as shown here in alphabetical order:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.camunda.bpm.engine.&#42;
&#8230; 
AuthorizationService authorizationService
FormService formService
HistoryService historyService
IdentityService identityService
ManagementService managementService
RepositoryService repositoryService
RuntimeService runtimeService
TaskService taskService</pre></div><p class="paragraph"/><blockquote class="note"> Note that many of these bean names are quite generic (like 'taskService', 'managementService' etc) and
could easily clash with names you want to use in your application for other purposes - even more so when having in
mind the Grails naming convention to use <strong class="bold">&#42;Service</strong> as a name pattern for Grails services. On the other hand
typical camunda users are used to the service names shown above and will expect to use these services via their
established names. Therefore the plugin provides these services via those names shown above. However, in order to
avoid potential name conflicts with grails services pre-existing in your project, the plugin also allows to
<strong class="bold">change these default bean names</strong> via <a href="../guide/single.html#bean-names" class="guide">configuration</a>. </blockquote><p class="paragraph"/>In addition to the camunda API services, the ProcessEngine itself can be used as an injectable
dependency, too:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.camunda.bpm.engine.&#42;
&#8230; 
ProcessEngine processEngine</pre></div><p class="paragraph"/>As an alternative to building your custom 'full fledged' grails application, you might 
want to use <strong class="bold"><a href="http://docs.camunda.org/latest/guides/user-guide/#tasklist" target="blank">camunda tasklist</a></strong> 
to work yourself through your processes. In that case you will want to create 
some forms which can be presented to your camunda BPM tasklist user.


<h2 id="embedded-forms">4.3 Develop a camunda BPM tasklist application</h2>
<blockquote class="note">
Using the camunda BPM tasklist with 'embedded' forms as described in this section, will just 
work with a 'shared' process engine <a href="../guide/single.html#deployment-scenario" class="guide">deployment scenario</a>.
</blockquote><p class="paragraph"/><img border="0" class="center" src="../img/tasklist-dashboard.png"></img><p class="paragraph"/>With the help of the <strong class="bold">camunda Grails Plugin</strong> you can <strong class="bold">use grails gsp views to dynamically</strong> 
<strong class="bold">render 'embedded' forms</strong> and hook them to the camunda BPM tasklist. You just need two things: 
<strong class="bold">First</strong>, place your form into the views folder, like e.g. ...<p class="paragraph"/><div class="code"><pre>/grails&#45;app/views/test/sampleForm.gsp</pre></div><p class="paragraph"/>&#8230; and <strong class="bold">second</strong>, associate your form to your process definition by attaching an attribute 
<strong class="bold">camunda:formKey</strong> to your 'userTask' xml element:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;userTask id=<span class="xml&#45;quote">"UserTask_1"</span> name=<span class="xml&#45;quote">"Sample UserTask"</span> camunda:formKey=<span class="xml&#45;quote">"embedded:app:camunda/test/sampleForm"</span>/&#62;</span></pre></div><p class="paragraph"/>Or, for a start event, it would look very similar:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;startEvent id=<span class="xml&#45;quote">"StartEvent_1"</span> name=<span class="xml&#45;quote">"Sample StartEvent"</span> camunda:formKey=<span class="xml&#45;quote">"embedded:app:camunda/test/sampleForm"</span>/&#62;</span></pre></div><p class="paragraph"/>Of course, you can also do this by making use of the camunda modeler properties pane:<p class="paragraph"/><img border="0" class="center" src="../img/modeler-form-key.png"></img><p class="paragraph"/>But what happens now behind the scenes at run time? First, when you start a process or open a task with 
camunda BPM task list, it will realise that you want to use an 'embedded' form and that you want to 
provide it via your grails web 'app' (from camunda's tasklist perspective you provide it from the 
application, which deployed the process definition with that formKey). The tasklist will therefore 
request the form from the absolute path '/your-grails-app-context/camunda/test/sampleForm'. The string 
'camunda/test/sampleForm' is the string you provided in the formKey. camunda Grails Plugin will then 
respond with the html <strong class="bold">body</strong> only of your 'test/sampleForm.gsp' and deliver it to the task list (by 
means of a plugin provided grails controller named 'camunda').<p class="paragraph"/><blockquote class="note">
Make sure that the body of your gsp just contains a single <strong class="bold">form</strong> element and that the html follows 
the conventions for camunda embedded forms. Of course you are free to dynamically generate that html 
via gsp mechanisms. To learn more about camunda embedded forms, you may want to look at the 
<a href="https://github.com/plexiti/camunda-grails-plugin/blob/master/grails-app/views/test/sampleForm.gsp" target="blank">raw html code</a> 
of the sample form provided with <strong class="bold">camunda Grails Plugin</strong> or consult camunda's 
<a href="http://docs.camunda.org/latest/guides/user-guide/#tasklist-task-forms-creating-embedded-task-forms" target="blank">embedded-task-forms docs</a>.
</blockquote>
 


<h2 id="custom-form-controllers">4.4 Redirect camunda BPM tasklist to your own grails application</h2>
Of course, you are also free to use your own controller actions to deliver forms, be it for embedded purposes...<p class="paragraph"/><div class="code"><pre>camunda:formKey=<span class="java&#45;quote">"embedded:app:forms/index"</span></pre></div><p class="paragraph"/>or as an external form link clickable via the task list:<p class="paragraph"/><div class="code"><pre>camunda:formKey=<span class="java&#45;quote">"app:forms/index"</span></pre></div><p class="paragraph"/>In both cases camunda's task list would now invoke your 'FormsController's 'index()' method (provided 
you use a standard grails UrlMappings layout). For embedded forms it would again expect to see just a HTML 
'form' element. 
For <a href="http://docs.camunda.org/latest/guides/user-guide/#tasklist-task-forms-external-task-forms" target="blank">external forms</a>, 
you would render the full page yourself and would also need to take care of the subsequent form actions 
yourself. camunda BPM tasklist will provide you with a <code>taskId</code> url parameter to look up the task as well 
as with a <code>callbackUrl</code> parameter to redirect back to the task list.


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/conventions.html">&lt;&lt; <strong>3</strong><span>A Word about Conventions</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/configuration.html"><strong>5</strong><span>Configuration Guide</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Beans</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Beans/authorizationService.html">authorizationService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/formService.html">formService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/historyService.html">historyService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/identityService.html">identityService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/managementService.html">managementService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/processEngine.html">processEngine</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/repositoryService.html">repositoryService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/runtimeService.html">runtimeService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Beans/taskService.html">taskService</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-process.html">create-process</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    <div>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons 4.0" style="border-width:0; vertical-align: middle" src="http://i.creativecommons.org/l/by/4.0/80x15.png"></img></a>
<span style="vertical-align: middle"><a href="http://github.com/martinschimak" property="cc:attributionName" rel="cc:attributionURL">Martin Schimak</a>, 
<a href="http://plexiti.com" property="cc:attributionName" rel="cc:attributionURL">plexiti GmbH</a></span>
</div>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
